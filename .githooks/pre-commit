# Create .githooks\pre-commit (no extension) as a tiny shell script
@'
#!/usr/bin/env sh
# Cross-platform shim to run the PowerShell pre-commit hook
if command -v pwsh >/dev/null 2>&1; then
  pwsh -NoProfile -ExecutionPolicy Bypass -File "$(dirname "$0")/pre-commit.ps1"
else
  powershell -NoProfile -ExecutionPolicy Bypass -File "$(dirname "$0")/pre-commit.ps1"
fi
'@ | Out-File -FilePath .githooks\pre-commit -Encoding utf8 -NoNewline
